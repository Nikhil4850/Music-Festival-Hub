<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logout Test - Music Festival Hub</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div style="padding: 50px; text-align: center; background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%); min-height: 100vh;">
        <h1 style="color: white; font-size: 2.5rem; margin-bottom: 20px; background: linear-gradient(135deg, #ff006e, #8b5cf6); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Logout Test</h1>
        <p style="color: #cccccc; font-size: 1.2rem; margin-bottom: 30px;">Testing if logout works properly without auto-login</p>
        
        <div style="background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 30px; max-width: 600px; margin: 0 auto;">
            <h2 style="color: white; margin-bottom: 20px;">Current User Status</h2>
            <div id="user-status" style="margin-bottom: 30px; padding: 20px; background: rgba(0, 0, 0, 0.3); border-radius: 10px; color: #cccccc;">
                Checking user status...
            </div>
            
            <button onclick="logoutUser()" style="padding: 15px 30px; font-size: 18px; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border: none; border-radius: 10px; cursor: pointer; margin: 10px; transition: all 0.3s ease;">
                Logout User
            </button>
            
            <button onclick="createTestUser()" style="padding: 15px 30px; font-size: 18px; background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; border-radius: 10px; cursor: pointer; margin: 10px; transition: all 0.3s ease;">
                Create Test User
            </button>
            
            <div style="margin-top: 30px;">
                <a href="login.html" style="display: inline-block; margin: 10px; padding: 12px 24px; background: rgba(255, 255, 255, 0.1); color: white; text-decoration: none; border-radius: 8px; transition: all 0.3s ease;">Go to Login Page</a>
                <a href="user-dashboard.html" style="display: inline-block; margin: 10px; padding: 12px 24px; background: rgba(255, 255, 255, 0.1); color: white; text-decoration: none; border-radius: 8px; transition: all 0.3s ease;">Go to Dashboard</a>
                <a href="index.html" style="display: inline-block; margin: 10px; padding: 12px 24px; background: rgba(255, 255, 255, 0.1); color: white; text-decoration: none; border-radius: 8px; transition: all 0.3s ease;">Go to Home</a>
            </div>
        </div>
    </div>

    <script src="auth-manager.js"></script>
    <script>
        // Check current user status
        function checkUserStatus() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const userStatusDiv = document.getElementById('user-status');
            
            if (currentUser.email && currentUser.isLoggedIn === true) {
                userStatusDiv.innerHTML = `
                    <div style="color: #4ade80;">
                        <h3>✅ User Logged In</h3>
                        <p><strong>Name:</strong> ${currentUser.name || 'N/A'}</p>
                        <p><strong>Email:</strong> ${currentUser.email}</p>
                        <p><strong>Logged In:</strong> ${currentUser.isLoggedIn ? 'Yes' : 'No'}</p>
                        <p><strong>Login Time:</strong> ${currentUser.loginTime ? new Date(currentUser.loginTime).toLocaleString() : 'N/A'}</p>
                    </div>
                `;
            } else {
                userStatusDiv.innerHTML = `
                    <div style="color: #f87171;">
                        <h3>❌ No User Logged In</h3>
                        <p>No active user session found</p>
                        <p><strong>Storage Data:</strong> ${JSON.stringify(currentUser)}</p>
                    </div>
                `;
            }
        }
        
        // Logout user
        function logoutUser() {
            // Use authManager logout if available
            if (typeof authManager !== 'undefined' && authManager.currentUser) {
                authManager.logout();
            } else {
                // Fallback logout method
                localStorage.removeItem('currentUser');
                
                // Show notification
                showNotification('User logged out successfully!', 'success');
                
                // Redirect after a short delay
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1500);
            }
            
            // Update display
            setTimeout(checkUserStatus, 100);
        }
        
        // Create a test user
        function createTestUser() {
            const testUser = {
                email: 'test@example.com',
                name: 'Test User',
                isLoggedIn: true,
                loginTime: new Date().getTime()
            };
            
            localStorage.setItem('currentUser', JSON.stringify(testUser));
            checkUserStatus();
            
            // Show notification
            showNotification('Test user created successfully!', 'success');
        }
        
        // Show notification
        function showNotification(message, type) {
            // Remove any existing notifications
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            // Add styles
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? 'rgba(72, 187, 120, 0.9)' : type === 'error' ? 'rgba(220, 38, 38, 0.9)' : 'rgba(59, 130, 246, 0.9)'};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 10000;
                display: flex;
                align-items: center;
                gap: 10px;
                backdrop-filter: blur(10px);
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // Check user status when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Also listen for storage changes
            window.addEventListener('storage', function(e) {
                if (e.key === 'currentUser') {
                    checkUserStatus();
                }
            });
            
            checkUserStatus();
        });
    </script>
</body>
</html>